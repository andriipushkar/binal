# Binance Balance Tracker (Покращена версія)

## Опис Проєкту

Цей проєкт є Python застосунком для отримання детальної інформації про баланси на вашому акаунті Binance, включаючи спотовий, Earn (Simple Earn), USDT-M ф'ючерсний та COIN-M ф'ючерсний гаманці. Застосунок використовує офіційний API Binance та надає гнучкі можливості для отримання та збереження звітів.

## Основні можливості

* **Безпечне завантаження API ключів:** Використовується файл `.env` для зберігання ключів.
* **Підключення до Binance API:** Надійна ініціалізація клієнта з механізмом повторних спроб.
* **Отримання деталей балансу:**
    * Спотовий гаманець.
    * Binance Earn (Simple Earn: Flexible та Locked продукти).
    * Ф'ючерсний гаманець USDT-M.
    * Ф'ючерсний гаманець COIN-M.
* **Оцінка вартості активів у USD:** Використовує прямі пари зі стейблкоїнами (USDT, BUSD) або конвертацію через BTC/BNB, з кешуванням цін.
* **Фільтрація "пилу":** Можливість встановлення порогу в USD для ігнорування активів з низькою вартістю на спотовому та Earn рахунках.
* **Форматування та вивід інформації:**
    * Зручне табличне представлення балансів у текстових звітах (для Spot, Earn, COIN-M).
* **Детальне логування:** Запис процесу виконання, попереджень та помилок у файли логів з унікальними іменами для кожного запуску.
* **Збереження даних:** Генерація звітів у форматах JSON (структуровані дані) та TXT (людиночитабельний формат).
* **Гнучкий запуск:**
    * Головна точка входу `balance.main` з аргументами командного рядка для вибору типів звітів та налаштування порогу "пилу".
    * Окремі скрипти-обгортки для швидкого запуску генерації звітів по конкретних гаманцях.
* **Модульна структура:** Проєкт організовано як Python пакет (`balance`) з розділенням логіки на модулі (API, обробка даних, конфігурація, генерація звітів, запуск скриптів).

## Структура Проєкту

pro1/                                       # Коренева папка проєкту
├── balance_binance.py                      # Скрипт: отримує повний баланс (застарілий, рекомендується balance.main)
├── spot_account_binance.py                 # Скрипт: отримує лише спотовий баланс
├── futures_account_binance.py              # Скрипт: отримує лише USDT-M ф'ючерсний баланс (перейменовано на usdtm_account_binance.py або використовувати balance.main --usdtm)
├── earn_account_binance.py                 # Скрипт: отримує лише Earn баланс
├── coin_m_futures_account_binance.py       # (Рекомендовано створити) Скрипт: отримує лише COIN-M ф'ючерсний баланс
├── requirements.txt                        # Файл із залежностями проєкту
├── balance/                                # Основний Python пакет проєкту
│   ├── __init__.py                     # Позначає balance як Python пакет
│   ├── main.py                         # Головна точка входу пакета (python -m balance.main)
│   ├── api.py                          # Модуль: функції для взаємодії з Binance API
│   ├── config.py                       # Модуль: конфігурація шляхів та налаштування логування
│   ├── data_processing.py              # Модуль: функції для обробки, форматування даних
│   ├── report_generator.py             # Модуль: функції для генерації вмісту звітів
│   ├── script_runner.py                # Модуль: універсальна логіка запуску отримання звітів
│   ├── logs/                           # Папка для файлів логів
│   │   └── YYYY-MM-DD_HH-MM-SS_*.log   # Файли логів
│   └── output/                         # Папка для вихідних файлів JSON/TXT
│       ├── balance_output.json / .txt
│       ├── spot_account_binance_output.json / .txt
│       ├── futures_usdt_account_binance_output.json / .txt
│       ├── futures_coin_m_account_binance_output.json / .txt
│       └── earn_account_binance_output.json / .txt
└── service/                                # Папка: службові файли
    └── .env                            # Файл: містить API ключі

## Передумови

* **Python 3.7+**
* **Binance акаунт** з налаштованими API ключами.
    * **Важливо:** Надайте API ключам лише необхідні дозволи (читання для балансів, дозвіл на ф'ючерси, якщо потрібно). Рекомендується обмежити доступ за IP-адресою.

## Встановлення

1.  **Клонуйте репозиторій** (або створіть структуру папок).
2.  **Встановіть залежності:**
    Відкрийте термінал у кореневій папці проєкту (`pro1/`) та виконайте:
    ```bash
    pip install -r requirements.txt
    ```

## Налаштування API Ключів

1.  У папці `pro1/` створіть підпапку `service/`.
2.  Всередині `service/` створіть файл `.env`.
3.  Додайте ваші API ключі до файлу `.env`:
    ```dotenv
    BINANCE_API_KEY=ВАШ_API_KEY
    BINANCE_SECRET_KEY=ВАШ_SECRET_KEY
    ```

## Як Запустити

Рекомендований спосіб запуску – через головний модуль `balance.main`, який надає гнучкі опції через аргументи командного рядка. Запускати з **кореневої папки проєкту** (`pro1/`).

### Запуск через `balance.main` (рекомендовано)

```bash
python -m balance.main [АРГУМЕНТИ]



Доступні аргументи:

-h, --help: Показати довідку.
--spot: Отримати звіт по спотовому балансу.
--usdtm: Отримати звіт по USDT-M ф'ючерсному балансу.
--coinm: Отримати звіт по COIN-M ф'ючерсному балансу.
--earn: Отримати звіт по Earn балансу.
--full: Отримати повний звіт по всіх гаманцях (Spot, Earn, USDT-M, COIN-M). Це поведінка за замовчуванням, якщо не вказано жодного іншого прапорця типу звіту.
--dust-threshold VALUE: Встановити поріг для фільтрації "пилу" в USD (наприклад, 0.05). Активи (на спотовому та Earn рахунках) з вартістю нижче цього порогу не будуть детально відображені, але їх загальна вартість буде підрахована. За замовчуванням: 0.01.
Приклади команд:

Отримати повний звіт:
Bash

python -m balance.main
або
Bash

python -m balance.main --full
Отримати тільки спотовий баланс з порогом пилу 0.5 USD:
Bash

python -m balance.main --spot --dust-threshold 0.5
Отримати звіти по Earn та COIN-M ф'ючерсах:
Bash

python -m balance.main --earn --coinm
Запуск окремих скриптів (спрощені обгортки)
Ці скрипти знаходяться в кореневій папці pro1/ і надають швидкий спосіб для отримання конкретних звітів з налаштуваннями за замовчуванням.

python spot_account_binance.py (для спотового звіту)
python usdtm_account_binance.py (для USDT-M ф'ючерсів - рекомендую перейменувати futures_account_binance.py для ясності)
python earn_account_binance.py (для Earn звіту)
python coin_m_futures_account_binance.py (новий скрипт для COIN-M, якщо створено)
python balance_binance.py (для повного звіту, аналогічно python -m balance.main --full)
Примітка: Окремі скрипти викликають script_runner з фіксованим типом звіту. Для налаштування порогу пилу через них, потрібно додати логіку argparse безпосередньо в ці скрипти.

Огляд Модулів Пакету balance
main.py: Головна точка входу з обробкою аргументів командного рядка.
api.py: Функції для взаємодії з Binance API (отримання балансів, цін), включаючи механізм повторних спроб та фільтрацію "пилу".
config.py: Централізована конфігурація шляхів до файлів/папок та функція налаштування логування.
data_processing.py: Функції для форматування даних у таблиці (pandas) та збереження результатів у файли JSON/TXT.
report_generator.py: Функції для підготовки структури та вмісту JSON та TXT звітів для кожного типу гаманця.
script_runner.py: Універсальна функція, що координує процес отримання даних, їх обробки та збереження звітів.
Вихідні Файли
Звіти зберігаються у папці pro1/balance/output/. Імена файлів залежать від типу запитаного звіту:

balance_output.json, balance_output.txt: Повний звіт.
spot_account_binance_output.json, spot_account_binance_output.txt: Тільки спотовий баланс.
futures_usdt_account_binance_output.json, futures_usdt_account_binance_output.txt: Тільки USDT-M ф'ючерси.
futures_coin_m_account_binance_output.json, futures_coin_m_account_binance_output.txt: Тільки COIN-M ф'ючерси.
earn_account_binance_output.json, earn_account_binance_output.txt: Тільки Earn баланс.
Файли логів зберігаються у pro1/balance/logs/ з іменем, що включає дату, час та тип запущеного звіту (при запуску через balance.main).

Обробка Помилок
Проєкт включає обробку типових помилок API та мережевих проблем з механізмом повторних спроб. Усі важливі події, попередження та помилки логуються.

Подальші Вдосконалення (Ідеї)
Збереження історії балансів (SQLite, CSV).
Побудова графіків зміни балансу.
Сповіщення (Telegram).
Більш глибока деталізація для ф'ючерсних позицій (якщо потрібно).